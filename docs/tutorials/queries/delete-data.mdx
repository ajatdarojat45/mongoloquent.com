---
sidebar_position: 3
title: Deleting Models
---

import Sponsor from "../../sponsor.mdx";

## Deleting an Existing Model by its Primary Key

if you know the primary key of the model, you may delete the model without explicitly retrieving it by calling the destroy method. In addition to accepting the single primary key, the destroy method will accept multiple primary keys, an array of primary keys, or a collection of primary keys:

```js
import Flight from "./yourPath/Flight";

await Flight.destroy("10ab7e3d05d58a1ad246ee87");

await Flight.destroy(["20ab7e3d05d58a1ad246ee87", "30ab7e3d05d58a1ad246ee87"]);
```

## Deleting Models Using Queries

Of course, you may build an Mongoloquent query to delete all models matching your query's criteria. In this example, we will delete all flights that are marked as inactive.

```js
const deleted = await Flight.where("active", false).delete();
```

## Soft Deleting

In addition to actually removing records from your database, Mongoloquent can also "soft delete" models. When models are soft deleted, they are not actually removed from your database. Instead, a `deletedAt` attribute is set on the model indicating the date and time at which the model was "deleted". To enable soft deletes for a model, add the `softDelete` property to the model:

```js
import { Mongoloquent } from "mongoloquent";

class Flight extends Mongoloquent {
	static collection = "flights";
	static softDelete = true;
}
```

> The `SoftDelete` property will automatically cast `isDeleted` and `deletedAt` attributes to a `DateTime` / `Dayjs` instance for you.

Now, when you call the `delete` method on the model, these `isDeleted` will be set "true" and `deletedAt` property will be set to the current date and time. When querying a model that uses soft deletes, the soft deleted models will automatically be excluded from all query results.

### Restoring Soft Deleted Models

Sometimes you may wish to "un-delete" a soft deleted model. To restore a soft deleted model, you may call the `restore` method on a model. The `restore` method will set the model's `deletedAt` column to `null` and `isDeleted` column to `false`.

```js
await Flight.withTrashed().restore();
```

You may also combine the `restore` method with query methods to restore multiple models/data.

```js
await Flight.withTrashed()
	.where("airlineId", "20ab7e3d05d58a1ad246ee87")
	.restore();
```

## Permanently Deleting Models

Sometimes you may need to truly remove a model from your database. You may use the `forceDelete` method to permanently remove a soft deleted model from the database collection:

```js
await Flight.where("airlineId", "20ab7e3d05d58a1ad246ee87").forceDelete();
```

## Querying Soft Deleted Models

### Including Soft Deleted Models

As noted above, soft deleted models will automatically be excluded from query results. However, you may force soft deleted models to be included in a query's results by calling the `withTrashed` method on the query:

```js
import Flight from "./yourPath/Flight";

const flights = await Flight.withTrashed()
	.where("accountId", "10ab7e3d05d58a1ad246ee10")
	.get();
```

### Retrieving Only Soft Deleted Models

The `onlyTrashed` method will retrieve only soft deleted models:

```js
const flights = await Flight.onlyTrashed()
	.where("accountId", "10ab7e3d05d58a1ad246ee10")
	.get();
```

---

<Sponsor />
